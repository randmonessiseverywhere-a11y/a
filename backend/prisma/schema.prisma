// This is your Prisma schema file
// Learn more: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

// User model with role-based access control
model User {
  id        Int      @id @default(autoincrement())
  email     String   @unique
  password  String   // Should be hashed (bcrypt)
  role      Role     @default(USER)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

// Enum for user roles
enum Role {
  ADMIN  // Can manage learning paths and lessons
  USER   // Regular user, can only view published content
}

// Learning Path model - represents a course/track
model LearningPath {
  id          Int      @id @default(autoincrement())
  title       String   // e.g., "Web Application Security"
  description String   // Detailed description of the learning path
  published   Boolean  @default(false) // Only published paths visible to users
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  // One-to-many relationship: one learning path has many lessons
  lessons     Lesson[]
}

// Lesson model - individual learning content (PDF or video)
model Lesson {
  id             Int          @id @default(autoincrement())
  title          String       // e.g., "SQL Injection Basics"
  description    String?      // Optional description
  fileUrl        String       // Path to uploaded file: /uploads/pdfs/xyz.pdf
  fileType       FileType     // PDF or VIDEO
  order          Int          // Order within learning path (1, 2, 3...)
  published      Boolean      @default(false)
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt
  
  // Foreign key to learning path
  learningPathId Int
  learningPath   LearningPath @relation(fields: [learningPathId], references: [id], onDelete: Cascade)
  
  // REMOVED: creatorId field (not needed for basic functionality)
  
  // Composite unique constraint: ensures no duplicate orders within same learning path
  // @@unique([learningPathId, order])
}

// Enum for file types
enum FileType {
  PDF
  VIDEO
}